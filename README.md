# Image-Domain LSRTM of VSP Data with PSFs

This repository provides an implementation of **image-domain least-squares reverse time migration (ID-LSRTM)** for VSP data based on **point-spread-function (PSF) deconvolution in the wavenumber domain**.

The workflow consists of three main components:

1. Forward modeling  
2. Reverse Time Migration (RTM) and PSF computation  
3. Wavenumber-domain PSF deconvolution (ID-LSRTM)
   
---

## Directory Structure
├── forward/ # Forward modeling and scatter-point data simulation

├── RTM/ # RTM imaging and PSF calculation

├── kkdecon_acoustic/ # Image-domain LSRTM via PSF deconvolution

├── input/ # Velocity models and related inputs

├── output/ # Seismic data, RTM images, PSFs

└── parameter.txt # Control parameters for modeling and migration

---

## 1. Forward Modeling

The `forward` directory contains codes for generating:

- **Observed seismic data** using the true velocity model  
- **Scattered data** using discrete scatter points and the migration velocity model  

These two modes are controlled by the parameter: scatter_flag = 0 or 1

Make sure that the compiler path in the `Makefile` is consistent with your system environment.

All simulation outputs are written to the `output` directory.

### Input Models

- The **true velocity model** is provided in the input files.  
- The **migration velocity model** is generated by smoothing the true velocity model using a window size specified in `parameter.txt`.

---

## 2. Reverse Time Migration (RTM) and PSF Calculation

The RTM module uses the **same input and output directories** as the forward modeling step.

The execution mode is controlled by:

- `scatter_flag = 0` → standard RTM imaging  
- `scatter_flag = 1` → PSF computation using scatter points  

The resulting RTM images and PSFs are written to the `output` directory.  
These files must be copied to the `kkdecon_acoustic` directory for the next step.

---

## 3. Image-Domain LSRTM via PSF Deconvolution

The `kkdecon_acoustic` directory implements **image-domain LSRTM in the wavenumber domain** using **PSF-based deconvolution**.

### Required Inputs

The program requires:

- True and migration velocity models to calculate a reference reflectivity 
- RTM images (with and without up–down wavefield decomposition)  
- Imaging responses of scatter points (PSFs)

### Method

The main code performs:

- Wavenumber-domain PSF deconvolution  
- Local-windowed image-domain LSRTM  

The size of the local deconvolution window is determined based on the **maximum velocity** in the model.

### Compilation and Execution


Again, make sure the compiler path in the `Makefile` matches your system environment.

The deconvolved images and intermediate files are written to the `output` directory.

---

## Reference

For a detailed description of the theory, please refer to:

**“Image-domain LSRTM of VSP data with point-spread functions”**  
(submitted to *Computers & Geosciences*)



